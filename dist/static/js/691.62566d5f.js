"use strict";(self["webpackChunkmeBlog"]=self["webpackChunkmeBlog"]||[]).push([[691],{8691:function(e,a,t){t.r(a),t.d(a,{default:function(){return b}});var l=t(3396),r=t(7139),s=t(4870),u=t(8478),n=t(3495),d=t(2074),o=t(2574);const i=e=>((0,l.dD)("data-v-30189cb8"),e=e(),(0,l.Cn)(),e),c={class:"user-title"},m=i((()=>(0,l._)("h3",null,"用户列表",-1))),f={key:0},w=["onClick"],p=["onClick"],v=["onClick"];var k=(0,l.aZ)({__name:"UserMange",setup(e){const a=(0,s.iH)(),t=(0,s.iH)(),i=(0,s.iH)(!1),k=(0,s.iH)(!1),g=(0,s.qj)({userName:"",userPwd:"",confirmpwd:"",Grade:"1",State:!0,id:0}),_=async()=>{const e=await(0,u.fl)();e.status&&(a.value=e.data.map((e=>{switch(e.StateText=e.State?"启用":"停用",e.Grade){case 1:e.Grade="管理员";break;default:e.Grade="普通用户"}return e})))};(0,l.bv)((()=>{_()}));const b=async e=>{n.Z.confirm({title:"删除提示",icon:(0,l.Wm)(o.Z),content:"确认要删除此账号?",okText:"确定",cancelText:"取消",async onOk(){try{const a=await(0,u.ti)(e);a.status&&(d.ZP.success(a.statusText),_())}catch{return console.log("Oops errors!")}}})},W=async({id:e,State:a})=>{const t=await(0,u.wc)(e,!a);t.status&&_(),d.ZP.success(`${a?"禁用":"启用"}${t.message}`)},y=async(e,a)=>""===a?Promise.reject("请确认密码"):a!==g.userPwd?Promise.reject("两次密码不一致"):Promise.resolve(),h=()=>{t.value.validate().then((async()=>{console.log("values",g,(0,s.IU)(g));const{userName:e,userPwd:a,Grade:l,State:r}=g,n=await(0,u.cn)(e,a,Number(l),r);if(console.log(n),n.status)return d.ZP.success(n.statusText),_(),i.value=!1,t.value.resetFields(),!0;d.ZP.error(n.statusText)})).catch((e=>{console.log("error",e)}))},P=()=>{t.value.validate().then((async()=>{console.log("values",g,(0,s.IU)(g));const{userPwd:e,id:a}=g,l=await(0,u.ZU)(Number(a),e);if(l.status)return d.ZP.success(l.statusText),_(),k.value=!1,t.value.resetFields(),!0;d.ZP.error(l.statusText)})).catch((e=>{console.log("error",e)}))},U=()=>{t.value.resetFields(),k.value=!1},x=()=>{t.value.resetFields()},C=e=>{k.value=!0,g.id=e},Z=[{title:"用户名称",dataIndex:"userName",width:150,align:"center"},{title:"用户权限",dataIndex:"Grade",width:120,align:"center"},{title:"状态",dataIndex:"StateText",width:120,align:"center"},{title:"操作",dataIndex:"action",width:120,align:"center"}],G={userName:[{required:!0,message:"请输入名字",trigger:"blur"}],userPwd:[{required:!0,message:"请输入密码",trigger:"blur"}],confirmpwd:[{required:!0,validator:y,trigger:"blur"}],Grade:[{required:!0,message:"请选择用户权限",trigger:"change"}]};return(e,s)=>{const u=(0,l.up)("a-button"),n=(0,l.up)("a-table"),d=(0,l.up)("a-input"),o=(0,l.up)("a-form-item"),_=(0,l.up)("a-select-option"),y=(0,l.up)("a-select"),S=(0,l.up)("a-switch"),N=(0,l.up)("a-form"),T=(0,l.up)("a-modal");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l._)("div",c,[m,(0,l.Wm)(u,{type:"primary",onClick:s[0]||(s[0]=()=>{i.value=!0})},{default:(0,l.w5)((()=>[(0,l.Uk)("添加用户")])),_:1})]),(0,l.Wm)(n,{"data-source":a.value,style:{padding:"0 5px"},scroll:{y:400},columns:Z},{bodyCell:(0,l.w5)((({column:e,record:a})=>["action"===e.dataIndex?((0,l.wg)(),(0,l.iD)("span",f,[(0,l._)("a",{style:{"margin-right":"5px"},onClick:e=>W(a)},(0,r.zw)(a?.State?"禁用":"启用"),9,w),(0,l._)("a",{style:{"margin-right":"5px"},onClick:e=>b(a.id)},"删除",8,p),(0,l._)("a",{onClick:e=>C(a.id)},"更改密码",8,v)])):(0,l.kq)("",!0)])),_:1},8,["data-source"]),(0,l.Wm)(T,{visible:i.value,"onUpdate:visible":s[6]||(s[6]=e=>i.value=e),title:"添加用户",footer:null,onCancel:x},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{ref_key:"formRef",ref:t,model:g,rules:G},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{ref:"name",label:"账号",name:"userName"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{value:g.userName,"onUpdate:value":s[1]||(s[1]=e=>g.userName=e)},null,8,["value"])])),_:1},512),(0,l.Wm)(o,{ref:"name","has-feedback":"",label:"密码",name:"userPwd"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{value:g.userPwd,"onUpdate:value":s[2]||(s[2]=e=>g.userPwd=e),type:"password"},null,8,["value"])])),_:1},512),(0,l.Wm)(o,{ref:"name","has-feedback":"",label:"确认密码",name:"confirmpwd"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{value:g.confirmpwd,"onUpdate:value":s[3]||(s[3]=e=>g.confirmpwd=e),type:"password"},null,8,["value"])])),_:1},512),(0,l.Wm)(o,{label:"用户权限",name:"Grade"},{default:(0,l.w5)((()=>[(0,l.Wm)(y,{value:g.Grade,"onUpdate:value":s[4]||(s[4]=e=>g.Grade=e),placeholder:"选择用户权限"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{value:"1"},{default:(0,l.w5)((()=>[(0,l.Uk)("管理员")])),_:1}),(0,l.Wm)(_,{value:"2"},{default:(0,l.w5)((()=>[(0,l.Uk)("普通用户")])),_:1})])),_:1},8,["value"])])),_:1}),(0,l.Wm)(o,{label:"是否启用",name:"State"},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{checked:g.State,"onUpdate:checked":s[5]||(s[5]=e=>g.State=e)},null,8,["checked"])])),_:1}),(0,l.Wm)(o,{"wrapper-col":{span:14,offset:9}},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{type:"primary",onClick:h},{default:(0,l.w5)((()=>[(0,l.Uk)("保存")])),_:1}),(0,l.Wm)(u,{style:{"margin-left":"10px"},onClick:x},{default:(0,l.w5)((()=>[(0,l.Uk)("清空")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"]),(0,l.Wm)(T,{visible:k.value,"onUpdate:visible":s[9]||(s[9]=e=>k.value=e),title:"更改密码",footer:null,onCancel:x},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{ref_key:"formRef",ref:t,model:g,rules:G},{default:(0,l.w5)((()=>[(0,l.Wm)(o,{ref:"name","has-feedback":"",label:"密码",name:"userPwd"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{value:g.userPwd,"onUpdate:value":s[7]||(s[7]=e=>g.userPwd=e),type:"password"},null,8,["value"])])),_:1},512),(0,l.Wm)(o,{ref:"name","has-feedback":"",label:"确认密码",name:"confirmpwd"},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{value:g.confirmpwd,"onUpdate:value":s[8]||(s[8]=e=>g.confirmpwd=e),type:"password"},null,8,["value"])])),_:1},512),(0,l.Wm)(o,{"wrapper-col":{span:14,offset:9}},{default:(0,l.w5)((()=>[(0,l.Wm)(u,{type:"primary",onClick:P},{default:(0,l.w5)((()=>[(0,l.Uk)("修改")])),_:1}),(0,l.Wm)(u,{style:{"margin-left":"10px"},onClick:U},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1})])),_:1})])),_:1},8,["model"])])),_:1},8,["visible"])])}}}),g=t(89);const _=(0,g.Z)(k,[["__scopeId","data-v-30189cb8"]]);var b=_}}]);
//# sourceMappingURL=691.62566d5f.js.map